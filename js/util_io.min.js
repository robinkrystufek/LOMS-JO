function generateJOreport(){let e="data:text/csv;charset=utf-8,JO2,JO4,JO6,JO2/JO4,JO2/JO6,JO4/JO2,JO4/JO6,JO6/JO2,JO6/JO4\n"+Number(formRef.data.jo2).toPrecision(6)+","+Number(formRef.data.jo4).toPrecision(6)+","+Number(formRef.data.jo6).toPrecision(6)+","+Number(formRef.data.jo2/formRef.data.jo4).toPrecision(6)+","+Number(formRef.data.jo2/formRef.data.jo6).toPrecision(6)+","+Number(formRef.data.jo4/formRef.data.jo2).toPrecision(6)+","+Number(formRef.data.jo4/formRef.data.jo6).toPrecision(6)+","+Number(formRef.data.jo6/formRef.data.jo2).toPrecision(6)+","+Number(formRef.data.jo6/formRef.data.jo4).toPrecision(6)+"\n";switch("sellmeier"==formRef.data.radioIndexCalc?e+="Sellmeier A, Sellmeier B1,Sellmeier C1,Sellmeier B2,Sellmeier C2\n"+Number(formRef.data.const_sellmeier).toPrecision(6)+","+Number(formRef.data.a_sellmeier).toPrecision(6)+","+Number(formRef.data.b_sellmeier).toPrecision(6)+","+Number(formRef.data.c_sellmeier).toPrecision(6)+","+Number(formRef.data.d_sellmeier).toPrecision(6)+"\n":e+="direct refractive index input\n",formRef.data.radioInputType){case"ICS":e+="excitedState,U2,U4,U6,sigma,mean_peak_wl_nm,refractive_index,fExp,fCalc,sExp,sCalc,barycenter\n";for(let a=0;a<ref_REDB.length;a++)formRef.data.dataGrid[a].include&&(e+=ref_REDB[a].excitedState+","+formRef.data.dataGrid[a].u2+","+formRef.data.dataGrid[a].u4+","+formRef.data.dataGrid[a].u6+","+formRef.data.dataGrid[a].integratedCrossSectionCm2+","+Number(formRef.data.dataGrid[a].meanPeakWavelengthNm).toPrecision(6)+","+Number(formRef.data.dataGrid[a].refractiveIndex).toPrecision(6)+","+Number(formRef.data.dataGrid[a].fExp).toPrecision(6)+","+Number(formRef.data.dataGrid[a].fCalc).toPrecision(6)+","+Number(formRef.data.dataGrid[a].sExp).toPrecision(6)+","+Number(formRef.data.dataGrid[a].sCalc).toPrecision(6)+","+formRef.data.dataGrid[a].barycenter+"\n");break;case"FEXP":e+="excitedState,U2,U4,U6,mean_peak_wl_nm,refractive_index,fExp,fCalc,sExp,sCalc,barycenter\n";for(let a=0;a<ref_REDB.length;a++)formRef.data.dataGrid[a].include&&(e+=ref_REDB[a].excitedState+","+formRef.data.dataGrid[a].u2+","+formRef.data.dataGrid[a].u4+","+formRef.data.dataGrid[a].u6+","+Number(formRef.data.dataGrid[a].meanPeakWavelengthNm).toPrecision(6)+","+Number(formRef.data.dataGrid[a].refractiveIndex).toPrecision(6)+","+formRef.data.dataGrid[a].fExp+","+Number(formRef.data.dataGrid[a].fCalc).toPrecision(6)+","+Number(formRef.data.dataGrid[a].sExp).toPrecision(6)+","+Number(formRef.data.dataGrid[a].sCalc).toPrecision(6)+","+formRef.data.dataGrid[a].barycenter+"\n");break;case"SEXP":e+="excitedState,U2,U4,U6,refractive_index,sExp,sCalc,barycenter\n";for(let a=0;a<ref_REDB.length;a++)formRef.data.dataGrid[a].include&&(e+=ref_REDB[a].excitedState+","+formRef.data.dataGrid[a].u2+","+formRef.data.dataGrid[a].u4+","+formRef.data.dataGrid[a].u6+","+Number(formRef.data.dataGrid[a].refractiveIndex).toPrecision(6)+","+formRef.data.dataGrid[a].sExp+","+Number(formRef.data.dataGrid[a].sCalc).toPrecision(6)+","+formRef.data.dataGrid[a].barycenter+"\n");break;case"JO":e+="excitedState,refractive_index,barycenter\n";for(let a=0;a<ref_REDB.length;a++)e+=ref_REDB[a].excitedState+","+Number(formRef.data.dataGrid[a].refractiveIndex).toPrecision(6)+","+formRef.data.dataGrid[a].barycenter+"\n"}linkJO=document.createElement("a"),linkJO.setAttribute("href",encodeURI(e)),""!=formRef.data.sampleName?linkJO.setAttribute("download",formRef.data.sampleName+"_JO_export.csv"):linkJO.setAttribute("download","JO_export.csv"),document.body.appendChild(linkJO),linkJO.click()}function generateTransitionsReport(){linkTransitions.click()}function generateCombinationsReport(){linkCombinations.click()}function downloadTemplateData(){var e=document.createElement("a");filenamesTemplate.hasOwnProperty(re_edit)&&((e=document.createElement("a")).setAttribute("href",filenamesTemplate[re_edit]),e.setAttribute("download",filenamesTemplate[re_edit]),e.style.visibility="hidden",document.body.appendChild(e),e.click())}function downloadReferenceData(){var e=document.createElement("a");filenamesReference.hasOwnProperty(re_edit)&&((e=document.createElement("a")).setAttribute("href",filenamesReference[re_edit]),e.setAttribute("download",filenamesReference[re_edit]),e.style.visibility="hidden",document.body.appendChild(e),e.click())}function importArrayCSV(e){if([e.length,e[0].length][0]<8)return;let a="sellmeier"==e[1][1];formRef.data.radioIndexCalc=a?"sellmeier":"direct",formRef.data.const_sellmeier=a?Number(e[2][1]):"",formRef.data.a_sellmeier=a?Number(e[3][1]):"",formRef.data.b_sellmeier=a?Number(e[4][1]):"",formRef.data.c_sellmeier=a?Number(e[5][1]):"",formRef.data.d_sellmeier=a?Number(e[6][1]):"",ref_REDB.forEach(((r,t)=>{let d=0;0==d&&(formRef.data.dataGrid[t].include=!1),e.slice(9).forEach((o=>{r.excitedState!=o[0]||0==Number(o[4])&&"jo"!=e[8][4]?r.excitedState==o[0]&&(formRef.data.dataGrid[t].barycenter=Number(o[7])):(formRef.data.dataGrid[t].u2=Number(o[1]),formRef.data.dataGrid[t].u4=Number(o[2]),formRef.data.dataGrid[t].u6=Number(o[3]),formRef.data.dataGrid[t].meanPeakWavelengthNm=Number(o[5]),formRef.data.dataGrid[t].include=!0,formRef.data.dataGrid[t].barycenter=Number(o[7]),a||(formRef.data.dataGrid[t].refractiveIndex=Number(o[6])),"fexp"==e[8][4]?(formRef.data.dataGrid[t].fexp=Number(o[4]),formRef.data.radioInputType="FEXP"):"sexp"==e[8][4]?(formRef.data.dataGrid[t].sexp_disp=Number(o[4]),formRef.data.radioInputType="SEXP"):"jo"==e[8][4]?(ref_REDB[0].excitedState==o[0]&&(formRef.data.jo2=Number(o[1]),formRef.data.jo4=Number(o[2]),formRef.data.jo6=Number(o[3]),formRef.data.dataGrid[t].u2=0,formRef.data.dataGrid[t].u4=0,formRef.data.dataGrid[t].u6=0),formRef.data.dataGrid[t].include=!1,formRef.data.radioInputType="JO"):(formRef.data.dataGrid[t].integratedCrossSectionCm2=Number(o[4]),formRef.data.radioInputType="ICS")),d++}))})),formRef.triggerRedraw(),document.getElementById("overlayloading").style.display="none"}function readFile(e){if(""!=formRef.data.sampleName?confirm("Do you want to overwrite the current sample name?")&&(formRef.data.sampleName=e.name.split(".")[0]):formRef.data.sampleName=e.name.split(".")[0],void 0===e)return void(document.getElementById("overlayloading").style.display="none");document.getElementById("overlayloading").style.display="block";const a=new FileReader;a.addEventListener("load",(e=>{let a=CSVToArray(e.target.result,",");document.querySelector("#filereport").textContent=JSON.stringify(a),formRef.getComponent("dataImportPanel").collapsed=!0,importArrayCSV(a)})),a.addEventListener("progress",(e=>{if(e.loaded&&e.total){e.loaded,e.total}})),a.readAsText(e)}function CSVToArray(e,a){a=a||",";for(var r=new RegExp("(\\"+a+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+a+"\\r\\n]*))","gi"),t=[[]],d=null;d=r.exec(e);){var o=d[1];if(o.length&&o!=a&&t.push([]),d[2])var i=d[2].replace(new RegExp('""',"g"),'"');else i=d[3];t[t.length-1].push(i)}return t}