function generateJOreport(){let a="data:text/csv;charset=utf-8,JO2,JO4,JO6,JO2/JO4,JO2/JO6,JO4/JO2,JO4/JO6,JO6/JO2,JO6/JO4\n"+Number(formRef.data.jo2).toPrecision(6)+","+Number(formRef.data.jo4).toPrecision(6)+","+Number(formRef.data.jo6).toPrecision(6)+","+Number(formRef.data.jo2/formRef.data.jo4).toPrecision(6)+","+Number(formRef.data.jo2/formRef.data.jo6).toPrecision(6)+","+Number(formRef.data.jo4/formRef.data.jo2).toPrecision(6)+","+Number(formRef.data.jo4/formRef.data.jo6).toPrecision(6)+","+Number(formRef.data.jo6/formRef.data.jo2).toPrecision(6)+","+Number(formRef.data.jo6/formRef.data.jo4).toPrecision(6)+"\n";switch("sellmeier"==formRef.data.radioIndexCalc?a+="Sellmeier A, Sellmeier B1,Sellmeier C1,Sellmeier B2,Sellmeier C2\n"+Number(formRef.data.const_sellmeier).toPrecision(6)+","+Number(formRef.data.a_sellmeier).toPrecision(6)+","+Number(formRef.data.b_sellmeier).toPrecision(6)+","+Number(formRef.data.c_sellmeier).toPrecision(6)+","+Number(formRef.data.d_sellmeier).toPrecision(6)+"\n":a+="direct refractive index input\n",formRef.data.radioInputType){case"ICS":a+="excitedState,U2,U4,U6,sigma,mean_peak_wl_nm,refractive_index,fExp,fCalc,sExp,sCalc,barycenter\n";for(let e=0;e<ref_REDB.length;e++)formRef.data.dataGrid[e].include&&(a+=ref_REDB[e].excitedState+","+formRef.data.dataGrid[e].u2+","+formRef.data.dataGrid[e].u4+","+formRef.data.dataGrid[e].u6+","+formRef.data.dataGrid[e].integratedCrossSectionCm2+","+Number(formRef.data.dataGrid[e].meanPeakWavelengthNm).toPrecision(6)+","+Number(formRef.data.dataGrid[e].refractiveIndex).toPrecision(6)+","+Number(formRef.data.dataGrid[e].fExp).toPrecision(6)+","+Number(formRef.data.dataGrid[e].fCalc).toPrecision(6)+","+Number(formRef.data.dataGrid[e].sExp).toPrecision(6)+","+Number(formRef.data.dataGrid[e].sCalc).toPrecision(6)+","+formRef.data.dataGrid[e].barycenter+"\n");break;case"FEXP":a+="excitedState,U2,U4,U6,mean_peak_wl_nm,refractive_index,fExp,fCalc,sExp,sCalc,barycenter\n";for(let t=0;t<ref_REDB.length;t++)formRef.data.dataGrid[t].include&&(a+=ref_REDB[t].excitedState+","+formRef.data.dataGrid[t].u2+","+formRef.data.dataGrid[t].u4+","+formRef.data.dataGrid[t].u6+","+Number(formRef.data.dataGrid[t].meanPeakWavelengthNm).toPrecision(6)+","+Number(formRef.data.dataGrid[t].refractiveIndex).toPrecision(6)+","+formRef.data.dataGrid[t].fExp+","+Number(formRef.data.dataGrid[t].fCalc).toPrecision(6)+","+Number(formRef.data.dataGrid[t].sExp).toPrecision(6)+","+Number(formRef.data.dataGrid[t].sCalc).toPrecision(6)+","+formRef.data.dataGrid[t].barycenter+"\n");break;case"SEXP":a+="excitedState,U2,U4,U6,refractive_index,sExp,sCalc,barycenter\n";for(let d=0;d<ref_REDB.length;d++)formRef.data.dataGrid[d].include&&(a+=ref_REDB[d].excitedState+","+formRef.data.dataGrid[d].u2+","+formRef.data.dataGrid[d].u4+","+formRef.data.dataGrid[d].u6+","+Number(formRef.data.dataGrid[d].refractiveIndex).toPrecision(6)+","+formRef.data.dataGrid[d].sExp+","+Number(formRef.data.dataGrid[d].sCalc).toPrecision(6)+","+formRef.data.dataGrid[d].barycenter+"\n");break;case"JO":a+="excitedState,refractive_index,barycenter\n";for(let r=0;r<ref_REDB.length;r++)a+=ref_REDB[r].excitedState+","+Number(formRef.data.dataGrid[r].refractiveIndex).toPrecision(6)+","+formRef.data.dataGrid[r].barycenter+"\n"}browserCheck(),(linkJO=document.createElement("a")).setAttribute("href",encodeURI(a)),""!=formRef.data.sampleName?linkJO.setAttribute("download",formRef.data.sampleName+"_JO_export.csv"):linkJO.setAttribute("download","JO_export.csv"),document.body.appendChild(linkJO),linkJO.click()}function generateTransitionsReport(){linkTransitions.click()}function generateCombinationsReport(){linkCombinations.click()}function downloadTemplateData(){if(filenamesTemplate.hasOwnProperty(re_edit)){browserCheck();var a=document.createElement("a");a.setAttribute("href",filenamesTemplate[re_edit]),a.setAttribute("download",filenamesTemplate[re_edit]),a.style.visibility="hidden",document.body.appendChild(a),a.click()}}function downloadReferenceData(){if(filenamesReference.hasOwnProperty(re_edit)){browserCheck();var a=document.createElement("a");a.setAttribute("href",filenamesReference[re_edit]),a.setAttribute("download",filenamesReference[re_edit]),a.style.visibility="hidden",document.body.appendChild(a),a.click()}}function browserCheck(){void 0!==window.safari&&alert("Safari does not support downloading files from this application with proper filename. File content is not affected. Please append .csv extension to the downloaded file name or use another browser.")}function importArrayCSV(a){let e=[a.length,a[0].length];if(e[0]<8)return;let t="sellmeier"==a[1][1];formRef.data.radioIndexCalc=t?"sellmeier":"direct",formRef.data.const_sellmeier=t?Number(a[2][1]):"",formRef.data.a_sellmeier=t?Number(a[3][1]):"",formRef.data.b_sellmeier=t?Number(a[4][1]):"",formRef.data.c_sellmeier=t?Number(a[5][1]):"",formRef.data.d_sellmeier=t?Number(a[6][1]):"",ref_REDB.forEach((e,d)=>{let r=0;0==r&&(formRef.data.dataGrid[d].include=!1),a.slice(9).forEach(i=>{e.excitedState==i[0]&&(0!=Number(i[4])||"jo"==a[8][4])?(formRef.data.dataGrid[d].u2=Number(i[1]),formRef.data.dataGrid[d].u4=Number(i[2]),formRef.data.dataGrid[d].u6=Number(i[3]),formRef.data.dataGrid[d].meanPeakWavelengthNm=Number(i[5]),formRef.data.dataGrid[d].include=!0,formRef.data.dataGrid[d].barycenter=Number(i[7]),t||(formRef.data.dataGrid[d].refractiveIndex=Number(i[6])),"fexp"==a[8][4]?(formRef.data.dataGrid[d].fexp=Number(i[4]),formRef.data.radioInputType="FEXP"):"sexp"==a[8][4]?(formRef.data.dataGrid[d].sexp_disp=Number(i[4]),formRef.data.radioInputType="SEXP"):"jo"==a[8][4]?(ref_REDB[0].excitedState==i[0]&&(formRef.data.jo2=Number(i[1]),formRef.data.jo4=Number(i[2]),formRef.data.jo6=Number(i[3]),formRef.data.dataGrid[d].u2=0,formRef.data.dataGrid[d].u4=0,formRef.data.dataGrid[d].u6=0),formRef.data.dataGrid[d].include=!1,formRef.data.radioInputType="JO"):(formRef.data.dataGrid[d].integratedCrossSectionCm2=Number(i[4]),formRef.data.radioInputType="ICS")):e.excitedState==i[0]&&(formRef.data.dataGrid[d].barycenter=Number(i[7])),r++})}),formRef.triggerRedraw(),document.getElementById("overlayloading").style.display="none"}function readFile(a){if(""!=formRef.data.sampleName?confirm("Do you want to overwrite the current sample name?")&&(formRef.data.sampleName=a.name.split(".")[0]):formRef.data.sampleName=a.name.split(".")[0],void 0===a){document.getElementById("overlayloading").style.display="none";return}document.getElementById("overlayloading").style.display="block";let e=new FileReader;e.addEventListener("load",a=>{let e=a.target.result,t=CSVToArray(e,",");document.querySelector("#filereport").textContent=JSON.stringify(t),formRef.getComponent("dataImportPanel").collapsed=!0,importArrayCSV(t)}),e.addEventListener("progress",a=>{a.loaded&&a.total&&(a.loaded,a.total)}),e.readAsText(a)}function CSVToArray(a,e){for(var t=RegExp("(\\"+(e=e||",")+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),d=[[]],r=null;r=t.exec(a);){var i=r[1];if(i.length&&i!=e&&d.push([]),r[2])var o=r[2].replace(RegExp('""',"g"),'"');else var o=r[3];d[d.length-1].push(o)}return d}var progressPercent=0;function updateProgressBar(a){var e=document.getElementById("overlay-progress-bar");e.style.width=a+"%",e.style.display="block",document.getElementById("overlay-progress-comment").style.display="block"}function showProgressBar(){document.getElementById("overlay-progress-bar").style.display="block",document.getElementById("overlay-progress-comment").style.display="block"}function hideProgressBar(){var a=document.getElementById("overlay-progress-bar");a.style.width="0%",a.style.display="none",document.getElementById("overlay-progress-comment").style.display="none"}